<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>S·∫£n Ph·∫©m - Thu·∫≠n ƒê·∫πp</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .product-img {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top top-head">
        <div class="container">
            <a class="navbar-brand" href="#">Thu·∫≠n ƒê·∫πp</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Trang Ch·ªß</a></li>
                    <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
                    <li class="nav-item"><a class="nav-link active" href="sanpham.html">S·∫£n Ph·∫©m</a></li>
                    <li class="nav-item"><a class="nav-link" href="uudai.html">∆Øu ƒê√£i</a></li>
                    <li class="nav-item"><a class="nav-link" href="lienhe.html">Li√™n H·ªá</a></li>
                    <li class="nav-item"><a class="nav-link" href="giohang.html">üõí Gi·ªè H√†ng (<span id="cart-count">0</span>)</a></li>
                </ul>
            </div>
        </div>
    </nav>
    
    <div class="container mt-5 pt-4">
        <h2 class="text-center mb-4">Danh S√°ch S·∫£n Ph·∫©m</h2>
        <div class="mb-3">
            <input type="text" id="searchInput" class="form-control" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m..." onkeyup="searchProducts()">
        </div>
        <div class="row" id="productList"></div>
    </div>

    <footer class="bg-dark text-light text-center py-3 mt-4 bottom-foot">
        <p class="mb-0">&copy; 2025 Thu·∫≠n ƒê·∫πp. All Rights Reserved.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            loadProducts();
            updateCartCount();
        });

        function loadProducts() {
            let products = JSON.parse(localStorage.getItem("products")) || [];
            displayProducts(products);
        }

        function displayProducts(products) {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';

            if (products.length === 0) {
                productList.innerHTML = "<p class='text-center'>Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o.</p>";
                return;
            }

            products.forEach(product => {
                // Ki·ªÉm tra n·∫øu s·∫£n ph·∫©m h·ª£p l·ªá
                if (!product.name || !product.image || !product.price || !product.link) return;

                productList.innerHTML += `
                    <div class="col-md-4 mb-4 product-item" data-name="${product.name.toLowerCase()}">
                        <div class="card">
                            <img src="${product.image}" class="card-img-top product-img" alt="${product.name}">
                            <div class="card-body">
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text text-danger fw-bold">${parseInt(product.price).toLocaleString("vi-VN")} VNƒê</p>

                                <a href="chitiet.html?name=${encodeURIComponent(product.name)}" class="btn btn-info">Xem chi ti·∫øt</a>
                                <button class="btn btn-primary" onclick='addToCart(${JSON.stringify(product)})'>Th√™m v√†o gi·ªè h√†ng</button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function searchProducts() {
            let input = document.getElementById('searchInput').value.toLowerCase();
            let productItems = document.querySelectorAll('.product-item');
            
            productItems.forEach(item => {
                let name = item.getAttribute('data-name');
                item.style.display = name.includes(input) ? "block" : "none";
            });
        }

        function addToCart(product) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            let index = cart.findIndex(item => item.name === product.name);
            if (index !== -1) {
                cart[index].quantity += 1;
            } else {
                product.quantity = 1;
                cart.push(product);
            }
            localStorage.setItem("cart", JSON.stringify(cart));
            updateCartCount();
            alert("S·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c th√™m v√†o gi·ªè h√†ng!");
        }

        function updateCartCount() {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            let count = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById("cart-count").innerText = count;
        }
    </script>
</body>
</html>
